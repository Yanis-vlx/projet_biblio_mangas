{% extends 'base.html.twig' %}

{% block title %}Catalogue{% endblock %}

{% block body %}
<main class="container mt-5 pt-5 text-black">

   
    <div class="d-flex justify-content-center align-items-start flex-wrap gap-3 mb-4">
        <div>
            {{ form_start(form, { 'attr': {'class': 'd-flex'} }) }}
                {{ form_widget(form.q, { 'attr': {'class': 'form-control me-2 border border-dark', 'placeholder': 'Rechercher...'} }) }}
                <button type="submit" class="btn btn-outline-dark">üîç</button>
            {{ form_end(form) }}
        </div>
        <form method="get" class="d-flex gap-2 justify-content-center">
            <select name="genre" class="form-select w-auto border border-dark">
                <option value="">Tous les genres</option>
                <option value="Shonen" {% if app.request.get('genre') == 'Shonen' %}selected{% endif %}>Shonen</option>
                <option value="Shojo" {% if app.request.get('genre') == 'Shojo' %}selected{% endif %}>Shojo</option>
                <option value="Seinen" {% if app.request.get('genre') == 'Seinen' %}selected{% endif %}>Seinen</option>
            </select>

            <select name="order" class="form-select w-auto border border-dark">
                <option value="ASC" {% if app.request.get('order') == 'ASC' %}selected{% endif %}>A ‚Üí Z</option>
                <option value="DESC" {% if app.request.get('order') == 'DESC' %}selected{% endif %}>Z ‚Üí A</option>
            </select>

            <button type="submit" class="btn btn-outline-dark mt-auto">Filtrer</button>
        </form>
        <a href="{{ path('app_admin_manga_new') }}" class="btn btn-outline-dark">Ajouter un manga</a>
        <a href="{{ path('app_admin_author_new') }}" class="btn btn-outline-dark">Ajouter un auteur</a>
        <a href="{{ path('app_admin_editor_new') }}" class="btn btn-outline-dark">Ajouter un √©diteur</a>
    </div>

 
    {% if mangas|length > 0 %}
    <ul class="list-group">
        {% for manga in mangas %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ manga.title }}</strong> ‚Äî 
                    {% for author in manga.authors %}
                        {{ author.name }}{% if not loop.last %}, {% endif %}
                    {% endfor %}
                    
                </div>
                <div class="btn-group" role="group">
                    <a href="{{ path('app_manga_show', {id: manga.id, from: 'admin'}) }}" class="btn btn-outline-dark btn-sm">D√©tails</a>

                    <a href="{{ path('app_admin_manga_edit', {id: manga.id}) }}" class="btn btn-outline-dark btn-sm">Modifier</a>

                    <form method="post" action="{{ path('app_admin_manga_delete', {id: manga.id}) }}" onsubmit="return confirm('Supprimer ce manga ?');" style="display:inline;">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ manga.id) }}">
                        <button type="submit" class="btn btn-outline-dark btn-sm rounded-start-0">Supprimer</button>
                    </form>
                </div>

            </li>
        {% endfor %}
    </ul>
    {% else %}
        <h3 class="text-center">Aucun manga √† afficher</h3>
    {% endif %}
</main>
{% endblock %}
